import{p as e,a as f,v as E,w as I,x as T}from"./chunk-NISHYRIK-BTx4j41q.js";import{E as A}from"./error-handler-CVdyEt7f.js";function R({question:i,selectedAnswer:s,onAnswerSelect:t,onSubmit:r,showResult:n,disabled:o=!1}){const l=d=>{o||n||t(d)},m=d=>{if(o||n)return;const u=Array.isArray(s)?s:[],p=u.includes(d)?u.filter(b=>b!==d):[...u,d];t(p)},a=d=>i.type==="single"?s===d:Array.isArray(s)&&s.includes(d),c=()=>o||n?!0:i.type==="single"?!s:!Array.isArray(s)||s.length===0,x=d=>{const u=d.match(/^([A-Z])\./);return u?u[1]:d.charAt(0)};return e.jsxs("div",{className:"card-base touch-friendly",children:[e.jsxs("header",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex flex-wrap gap-2 mb-3 sm:mb-4",children:[e.jsxs("span",{className:"inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-200",children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 7h.01M7 3h5c.512 0 1.024.195 1.414.586l7 7a2 2 0 010 2.828l-7 7a2 2 0 01-2.828 0l-7-7A1.994 1.994 0 013 12V7a4 4 0 014-4z"})}),i.domain]}),e.jsxs("span",{className:`inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium ${i.difficulty==="easy"?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":i.difficulty==="medium"?"bg-yellow-100 text-yellow-800 dark:bg-yellow-900 dark:text-yellow-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}`,children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 10V3L4 14h7v7l9-11h-7z"})}),i.difficulty==="easy"?"初級":i.difficulty==="medium"?"中級":"上級"]}),e.jsxs("span",{className:"inline-flex items-center px-2 sm:px-3 py-1 rounded-full text-xs sm:text-sm font-medium bg-purple-100 text-purple-800 dark:bg-purple-900 dark:text-purple-200",children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),i.type==="single"?"単一回答":"複数回答"]})]}),e.jsx("h2",{className:"text-responsive-lg font-semibold text-gray-900 dark:text-white leading-relaxed mb-3",children:i.question}),i.type==="multiple"&&e.jsxs("div",{className:"flex items-center p-3 bg-amber-50 dark:bg-amber-900/20 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsx("svg",{className:"w-5 h-5 text-amber-600 dark:text-amber-400 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-amber-800 dark:text-amber-200",children:"複数の選択肢を選択してください"}),Array.isArray(s)&&s.length>0&&e.jsxs("p",{className:"text-xs text-amber-700 dark:text-amber-300 mt-1",children:["選択済み: ",s.length,"個"]})]})]})]}),e.jsxs("div",{className:"space-y-2 sm:space-y-3 mb-6",role:"group","aria-labelledby":"question-options",children:[e.jsx("div",{id:"question-options",className:"sr-only",children:"回答選択肢"}),i.options.map((d,u)=>{const p=x(d),b=a(p);return e.jsxs("label",{className:`
                flex items-start p-3 sm:p-4 border rounded-lg cursor-pointer transition-all duration-200 touch-friendly
                ${b?i.type==="multiple"?"border-green-500 bg-green-50 dark:bg-green-900/20 dark:border-green-400 shadow-sm":"border-blue-500 bg-blue-50 dark:bg-blue-900/20 dark:border-blue-400 shadow-sm":"border-gray-200 dark:border-gray-600 hover:bg-gray-50 dark:hover:bg-gray-700"}
                ${o||n?"cursor-not-allowed opacity-60":"hover:shadow-sm active:scale-95"}
              `,children:[e.jsx("input",{type:i.type==="single"?"radio":"checkbox",name:i.type==="single"?`question-${i.id}`:`answer-${i.id}`,value:p,checked:b,onChange:()=>{i.type==="single"?l(p):m(p)},disabled:o||n,className:`
                  mt-0.5 sm:mt-1 mr-3 flex-shrink-0 w-4 h-4 sm:w-5 sm:h-5
                  ${i.type==="single"?"text-blue-600 focus:ring-blue-500 focus:ring-2":"text-blue-600 focus:ring-blue-500 focus:ring-2 rounded"}
                  ${o||n?"opacity-50 cursor-not-allowed":"cursor-pointer"}
                `,"aria-describedby":`option-${u}-text`}),e.jsx("span",{id:`option-${u}-text`,className:"text-responsive-sm text-gray-900 dark:text-gray-100 leading-relaxed",children:d})]},u)})]}),!n&&e.jsx("div",{className:"flex flex-col sm:flex-row justify-end gap-3",children:e.jsx("button",{onClick:r,disabled:c(),className:`
              w-full sm:w-auto px-6 py-3 sm:px-8 sm:py-3 rounded-lg font-medium transition-all duration-200 touch-friendly
              ${c()?"bg-gray-300 dark:bg-gray-600 text-gray-500 dark:text-gray-400 cursor-not-allowed":"btn-primary hover:shadow-lg active:scale-95"}
            `,"aria-label":"選択した回答を提出する",children:e.jsxs("span",{className:"flex items-center justify-center",children:["回答する",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 7l5 5m0 0l-5 5m5-5H6"})})]})})})]})}function z({question:i,answer:s,onNext:t,showNextButton:r=!0}){const n=()=>i.type==="single"?Array.isArray(s.correctAnswer)?s.correctAnswer[0]:s.correctAnswer:(Array.isArray(s.correctAnswer)?s.correctAnswer:[s.correctAnswer]).join(", "),o=()=>i.type==="single"?Array.isArray(s.userAnswer)?s.userAnswer[0]:s.userAnswer:(Array.isArray(s.userAnswer)?s.userAnswer:[s.userAnswer]).join(", "),l=()=>s.isCorrect?e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}):e.jsx("div",{className:"flex items-center justify-center w-12 h-12 bg-red-100 rounded-full mb-4",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),m=a=>{const c=a.match(/^([A-Z])\./)?.[1];if(!c)return null;const x=Array.isArray(s.correctAnswer)?s.correctAnswer:[s.correctAnswer],d=Array.isArray(s.userAnswer)?s.userAnswer:[s.userAnswer];return x.includes(c)?"✓ 正解":d.includes(c)?"✗ 不正解":null};return e.jsxs("div",{className:"mt-4 sm:mt-6 space-y-4 sm:space-y-6",children:[e.jsxs("div",{className:`
        rounded-lg p-4 sm:p-6 text-center
        ${s.isCorrect?"bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800":"bg-red-50 dark:bg-red-900/20 border border-red-200 dark:border-red-800"}
      `,children:[l(),e.jsx("h3",{className:`
          text-responsive-xl font-bold mb-3 sm:mb-4
          ${s.isCorrect?"text-green-800 dark:text-green-200":"text-red-800 dark:text-red-200"}
        `,children:s.isCorrect?"正解！":"不正解"}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-center gap-1 sm:gap-4",children:[e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 text-responsive-sm",children:"あなたの回答:"}),e.jsx("span",{className:`ml-2 font-bold text-responsive-sm ${s.isCorrect?"text-green-700 dark:text-green-300":"text-red-700 dark:text-red-300"}`,children:o()})]}),!s.isCorrect&&e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("span",{className:"font-medium text-gray-700 dark:text-gray-300 text-responsive-sm",children:"正解:"}),e.jsx("span",{className:"ml-2 font-bold text-green-700 dark:text-green-300 text-responsive-sm",children:n()})]})]})})]}),e.jsxs("div",{className:"card-base bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("h4",{className:"font-bold text-lg text-gray-900 dark:text-white mb-4 border-b border-gray-300 dark:border-gray-600 pb-2",children:e.jsx("span",{className:"text-gray-800 dark:text-gray-100",children:"選択肢の解説"})}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:i.options.map((a,c)=>{const x=m(a);return x?e.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 p-2 sm:p-3 bg-white dark:bg-gray-700 rounded-lg",children:[e.jsxs("span",{className:`
                  inline-flex items-center px-2 py-1 text-xs font-medium rounded-full flex-shrink-0
                  ${x.includes("✓")?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-200"}
                `,children:[x.includes("✓")?e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})}),x.includes("✓")?"正解":"不正解"]}),e.jsx("span",{className:"text-gray-700 dark:text-gray-300 text-responsive-sm leading-relaxed",children:a})]},c):null})})]}),e.jsxs("div",{className:"card-base",children:[e.jsxs("h4",{className:"font-bold text-lg text-gray-900 dark:text-white mb-4 flex items-center border-b border-gray-200 dark:border-gray-600 pb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"text-blue-900 dark:text-blue-100",children:"詳細解説"})]}),e.jsx("div",{className:"prose prose-sm sm:prose-base max-w-none dark:prose-invert",children:e.jsx("p",{className:"text-gray-700 dark:text-gray-300 leading-relaxed text-responsive-sm",children:i.explanation})})]}),i.learningResources&&i.learningResources.length>0&&e.jsxs("div",{className:"card-base bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800",children:[e.jsxs("h4",{className:"font-bold text-lg text-blue-900 dark:text-blue-200 mb-4 flex items-center border-b border-blue-300 dark:border-blue-700 pb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-blue-600 dark:text-blue-400 mr-3 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"})}),e.jsx("span",{className:"text-blue-800 dark:text-blue-100",children:"学習リソース"})]}),e.jsx("div",{className:"space-y-2 sm:space-y-3",children:i.learningResources.map((a,c)=>e.jsxs("div",{className:"flex items-start space-x-2 sm:space-x-3 p-2 sm:p-3 bg-white dark:bg-blue-800/30 rounded-lg",children:[e.jsxs("span",{className:`
                  inline-flex items-center px-2 py-1 text-xs font-medium rounded-full flex-shrink-0
                  ${a.type==="documentation"?"bg-blue-100 text-blue-800 dark:bg-blue-800 dark:text-blue-200":a.type==="blog"?"bg-green-100 text-green-800 dark:bg-green-800 dark:text-green-200":a.type==="video"?"bg-red-100 text-red-800 dark:bg-red-800 dark:text-red-200":"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-200"}
                `,children:[a.type==="documentation"?"📚":a.type==="blog"?"📝":a.type==="video"?"🎥":"📄",e.jsx("span",{className:"ml-1 hidden sm:inline",children:a.type==="documentation"?"ドキュメント":a.type==="blog"?"ブログ":a.type==="video"?"動画":"資料"})]}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("a",{href:a.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-700 dark:text-blue-300 hover:text-blue-900 dark:hover:text-blue-100 font-medium text-responsive-sm hover:underline block truncate",children:a.title}),a.description&&e.jsx("p",{className:"text-gray-600 dark:text-gray-400 text-responsive-xs mt-1 line-clamp-2",children:a.description})]}),e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4 text-gray-400 dark:text-gray-500 flex-shrink-0 mt-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 6H6a2 2 0 00-2 2v10a2 2 0 002 2h10a2 2 0 002-2v-4M14 4h6m0 0v6m0-6L10 14"})})]},c))})]}),i.relatedServices&&i.relatedServices.length>0&&e.jsxs("div",{className:"card-base bg-gray-50 dark:bg-gray-800/50",children:[e.jsx("h5",{className:"font-bold text-base text-gray-900 dark:text-white mb-3 border-b border-gray-300 dark:border-gray-600 pb-2",children:e.jsx("span",{className:"text-gray-800 dark:text-gray-100",children:"関連サービス"})}),e.jsx("div",{className:"flex flex-wrap gap-1 sm:gap-2",children:i.relatedServices.map((a,c)=>e.jsxs("span",{className:"inline-flex items-center bg-gray-200 dark:bg-gray-700 text-gray-700 dark:text-gray-300 text-xs px-2 py-1 rounded-full",children:[e.jsx("svg",{className:"w-3 h-3 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 3v2m6-2v2M9 19v2m6-2v2M5 9H3m2 6H3m18-6h-2m2 6h-2M7 19h10a2 2 0 002-2V7a2 2 0 00-2-2H7a2 2 0 00-2 2v10a2 2 0 002 2zM9 9h6v6H9V9z"})}),a]},c))})]}),r&&e.jsx("div",{className:"flex flex-col sm:flex-row justify-center gap-3 pt-2 sm:pt-4",children:e.jsx("button",{onClick:t,className:"btn-primary w-full sm:w-auto px-6 sm:px-8 py-3 hover:shadow-lg active:scale-95","aria-label":"次の問題に進む",children:e.jsxs("span",{className:"flex items-center justify-center",children:["次の問題",e.jsx("svg",{className:"w-4 h-4 ml-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})})]})})})]})}class L{static selectRandomQuestion(s,t=[],r,n={}){const{avoidRecentQuestions:o=!0,recentQuestionWindow:l=5,maxRetries:m=3}=n;let a=this.filterQuestions(s,r);if(a=a.filter(x=>!t.includes(x.id)),o&&t.length>0){const x=t.slice(-l);a=a.filter(d=>!x.includes(d.id))}if(a.length===0&&(a=this.filterQuestions(s,r),a.length===0))return null;if(n.preferDifficulty){const x=a.filter(d=>d.difficulty===n.preferDifficulty);x.length>0&&(a=x)}const c=Math.floor(Math.random()*a.length);return a[c]}static selectQuestionSet(s,t,r,n={}){const{balanceDomains:o=!0}=n,l=[],m=[];if(o&&!r?.domain)return this.selectBalancedQuestionSet(s,t,r,n);for(let a=0;a<t;a++){const c=this.selectRandomQuestion(s,m,r,n);if(c)l.push(c),m.push(c.id);else break}return l}static selectBalancedQuestionSet(s,t,r,n={}){const o=[],l=[],m=this.filterQuestions(s,r),a=[...new Set(m.map(d=>d.domain))];if(a.length===0)return[];const c=Math.floor(t/a.length),x=t%a.length;for(let d=0;d<a.length;d++){const u=a[d],p=c+(d<x?1:0),b={...r,domain:u};for(let g=0;g<p;g++){const y=this.selectRandomQuestion(s,l,b,n);y&&(o.push(y),l.push(y.id))}}for(;o.length<t;){const d=this.selectRandomQuestion(s,l,r,n);if(d)o.push(d),l.push(d.id);else break}return this.shuffleArray(o)}static selectNextQuestion(s,t,r={}){const n={domain:t.domainFilter};return this.selectRandomQuestion(s,t.usedQuestionIds,n,r)}static selectReviewQuestions(s,t,r=5){const o=t.answers.filter(a=>!a.isCorrect).map(a=>a.questionId),l=s.filter(a=>o.includes(a.id)),m=Math.min(r,l.length);return this.shuffleArray(l).slice(0,m)}static getDifficultyDistribution(s){const t={easy:0,medium:0,hard:0,total:s.length};for(const r of s)t[r.difficulty]++;return t}static getDomainDistribution(s){const t={};for(const r of s)t[r.domain]=(t[r.domain]||0)+1;return t}static filterQuestions(s,t){return t?s.filter(r=>!(t.domain&&r.domain!==t.domain||t.difficulty&&r.difficulty!==t.difficulty||t.type&&r.type!==t.type||t.tags&&t.tags.length>0&&!t.tags.some(o=>r.tags.includes(o))||t.excludeIds&&t.excludeIds.includes(r.id))):s}static shuffleArray(s){const t=[...s];for(let r=t.length-1;r>0;r--){const n=Math.floor(Math.random()*(r+1));[t[r],t[n]]=[t[n],t[r]]}return t}static checkDuplicates(s){const t=s.map(o=>o.id),r=[],n=new Set;for(const o of t)n.has(o)?r.push(o):n.add(o);return r}static getSelectionStats(s,t,r){const n=this.filterQuestions(s,r),o=n.filter(m=>!t.includes(m.id)),l={};for(const m of n)l[m.domain]||(l[m.domain]={total:0,used:0,available:0}),l[m.domain].total++,t.includes(m.id)?l[m.domain].used++:l[m.domain].available++;return{totalQuestions:n.length,availableQuestions:o.length,usedQuestions:t.length,usagePercentage:n.length>0?t.length/n.length*100:0,domainBreakdown:l}}}function F({questions:i,config:s,onComplete:t}){const r=f.useMemo(()=>{if(s.mode==="set"&&s.questionCount){const h=s.domain?{domain:s.domain}:void 0;return L.selectQuestionSet(i,s.questionCount,h,{balanceDomains:!0})}return L.shuffleArray(i)},[i,s.mode,s.questionCount,s.domain]),[n,o]=f.useState(0),[l,m]=f.useState(null),[a,c]=f.useState(""),[x,d]=f.useState(!1),[u,p]=f.useState({sessionId:`session_${Date.now()}`,startedAt:new Date,mode:s.mode,targetQuestionCount:s.questionCount,currentQuestionIndex:0,answers:[],usedQuestionIds:[],domainFilter:s.domain});f.useEffect(()=>{if(s.mode==="set")m(r[n]||null);else{const h=s.domain?{domain:s.domain}:void 0,j=L.selectRandomQuestion(i,u.usedQuestionIds,h,{avoidRecentQuestions:!0,recentQuestionWindow:5});m(j)}},[n,r,s.mode,s.domain,i,u.usedQuestionIds]);const b=f.useRef(0),g=f.useRef(0),y=f.useRef(null);f.useEffect(()=>{l&&c(l.type==="multiple"?[]:"")},[n,l]);const C=h=>{b.current=h.touches[0].clientX,g.current=h.touches[0].clientY},D=h=>{if(!h.changedTouches[0])return;const j=h.changedTouches[0].clientX,Q=h.changedTouches[0].clientY,k=j-b.current,w=Q-g.current;if(Math.abs(k)>Math.abs(w)&&Math.abs(k)>50)if(k>0&&n>0&&!x){const N=n-1;o(N),d(!1)}else k<0&&x&&S()},v=s.mode==="set"?(n+1)/s.questionCount*100:0,W=()=>{if(!l)return;const h=l.correctAnswer;let j=!1;if(l.type==="single")j=a===h;else{const w=Array.isArray(a)?[...a].sort():[a].sort(),N=Array.isArray(h)?[...h].sort():[h].sort();j=w.length===N.length&&w.every(($,B)=>$===N[B])}const Q={questionId:l.id,userAnswer:a,correctAnswer:h,isCorrect:j,answeredAt:new Date},k={...u,answers:[...u.answers,Q],usedQuestionIds:[...u.usedQuestionIds,l.id],currentQuestionIndex:n};p(k),d(!0)},S=()=>{const h=n+1;if(s.mode==="set"&&h>=s.questionCount){t(u);return}if(s.mode==="set"&&h>=r.length){t(u);return}if(o(h),s.mode==="set"){const j=r[h];c(j?.type==="multiple"?[]:"")}else c("");d(!1)},M=()=>u.answers[u.answers.length-1];return l?e.jsx("div",{className:"min-h-screen bg-gray-50 dark:bg-gray-900 py-4 sm:py-6 md:py-8",ref:y,onTouchStart:C,onTouchEnd:D,children:e.jsxs("div",{className:"container-responsive",children:[e.jsxs("header",{className:"mb-4 sm:mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("button",{onClick:()=>window.history.back(),className:"btn-secondary text-sm sm:text-base","aria-label":"メニューに戻る",children:[e.jsx("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),e.jsx("span",{className:"hidden sm:inline",children:"メニューに戻る"}),e.jsx("span",{className:"sm:hidden",children:"戻る"})]}),e.jsx("div",{className:"text-center",children:e.jsx("h1",{className:"text-responsive-lg font-semibold text-gray-900 dark:text-white",children:s.mode==="set"?"10問セット":"エンドレスモード"})}),e.jsx("div",{className:"w-20 sm:w-24"})," "]}),s.mode==="set"&&e.jsxs("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 sm:p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2 sm:mb-3",children:[e.jsxs("span",{className:"text-responsive-sm font-medium text-gray-700 dark:text-gray-300",children:["問題 ",n+1," / ",s.questionCount]}),e.jsxs("span",{className:"text-responsive-sm text-gray-500 dark:text-gray-400 font-mono",children:[Math.round(v),"%"]})]}),e.jsx("div",{className:"progress-bar",children:e.jsx("div",{className:"progress-fill",style:{width:`${v}%`},role:"progressbar","aria-valuenow":v,"aria-valuemin":0,"aria-valuemax":100,"aria-label":`進捗: ${Math.round(v)}%`})})]}),s.mode==="endless"&&e.jsx("div",{className:"bg-white dark:bg-gray-800 rounded-lg p-3 sm:p-4 shadow-sm border border-gray-200 dark:border-gray-700",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-responsive-lg font-bold text-blue-600 dark:text-blue-400",children:n+1}),e.jsx("div",{className:"text-responsive-xs text-gray-500 dark:text-gray-400",children:"問題数"})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"text-responsive-lg font-bold text-green-600 dark:text-green-400",children:[u.answers.length>0?Math.round(u.answers.filter(h=>h.isCorrect).length/u.answers.length*100):0,"%"]}),e.jsx("div",{className:"text-responsive-xs text-gray-500 dark:text-gray-400",children:"正答率"})]})]})})]}),e.jsx("main",{className:"mb-6",children:e.jsx(R,{question:l,selectedAnswer:a,onAnswerSelect:c,onSubmit:W,showResult:x})}),x&&M()&&e.jsx("section",{"aria-live":"polite","aria-label":"問題の結果",children:e.jsx(z,{question:l,answer:M(),onNext:S})}),e.jsx("div",{className:"block sm:hidden mt-4 text-center",children:e.jsx("div",{className:"inline-flex items-center text-xs text-gray-500 dark:text-gray-400 bg-gray-100 dark:bg-gray-800 px-3 py-2 rounded-full",children:x?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),"左にスワイプで次の問題"]}):n>0?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-4 h-4 mr-1",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5l7 7-7 7"})}),"右にスワイプで前の問題"]}):e.jsx("span",{children:"回答後、左にスワイプで次の問題"})})})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"問題が見つかりません"}),e.jsx("p",{className:"text-gray-600",children:"問題データの読み込みに失敗しました。"})]})})}function H({title:i="エラーが発生しました",message:s,showRetry:t=!1,showHome:r=!0,onRetry:n}){const o=E();return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center px-4",children:e.jsxs("div",{className:"max-w-md w-full",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6 text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100 mb-4",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L3.732 16.5c-.77.833.192 2.5 1.732 2.5z"})})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:i}),e.jsx("p",{className:"text-gray-600 mb-6",children:s}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3 justify-center",children:[t&&n&&e.jsx("button",{onClick:n,className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"再試行"}),r&&e.jsx("button",{onClick:()=>o("/"),className:"bg-gray-600 text-white px-6 py-2 rounded-lg hover:bg-gray-700 transition-colors font-medium",children:"メニューに戻る"})]})]}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-sm text-gray-500",children:"問題が続く場合は、ページを再読み込みしてください。"})})]})})}function P({onRetry:i}){return e.jsx(H,{title:"データ読み込みエラー",message:"問題データの読み込みに失敗しました。しばらく後にお試しください。",showRetry:!0,onRetry:i})}function X({message:i="読み込み中...",size:s="medium",fullScreen:t=!1}){const r={small:"h-6 w-6",medium:"h-12 w-12",large:"h-16 w-16"},n=t?"min-h-screen bg-gray-50 flex items-center justify-center":"flex items-center justify-center p-8";return e.jsx("div",{className:n,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`animate-spin rounded-full border-b-2 border-blue-600 mx-auto mb-4 ${r[s]}`}),e.jsx("p",{className:"text-gray-600",children:i})]})})}function Y(){return e.jsx(X,{message:"問題を読み込み中...",size:"medium",fullScreen:!0})}class O{cache=new Map;async loadQuestionSet(s="/questions.json"){try{if(this.cache.has(s))return{success:!0,data:this.cache.get(s)};const t=await this.fetchWithTimeout(s,1e4);if(!t.ok)throw new Error(`HTTP ${t.status}: ${t.statusText}`);const r=await t.json();if(!r.questions||!Array.isArray(r.questions))throw new Error("Invalid question data format");const n=r;return this.cache.set(s,n),{success:!0,data:n}}catch(t){return A.handleDataLoadError(t),this.handleError(t,"Failed to load question set")}}async loadQuestionsByDomain(s){try{const t=await this.loadQuestionSet();return!t.success||!t.data?{success:!1,error:t.error||"Failed to load question set"}:{success:!0,data:t.data.questions.filter(n=>n.domain===s)}}catch(t){return A.handleDataLoadError(t),this.handleError(t,`Failed to load questions for domain ${s}`)}}async reloadQuestionSet(s="/questions.json"){return this.cache.delete(s),this.loadQuestionSet(s)}clearCache(){this.cache.clear()}async fetchWithTimeout(s,t){const r=new AbortController,n=setTimeout(()=>r.abort(),t);try{const o=await fetch(s,{signal:r.signal,headers:{Accept:"application/json","Cache-Control":"no-cache"}});return clearTimeout(n),o}catch(o){if(clearTimeout(n),o instanceof Error&&o.name==="AbortError"){const l=new Error(`Request timeout after ${t}ms`);throw A.handleNetworkError(l),l}throw A.handleNetworkError(o),o}}handleError(s,t){let r=t;return s instanceof Error?r=s.message:typeof s=="string"&&(r=s),r.includes("Failed to fetch")?r="ネットワーク接続に失敗しました。インターネット接続を確認してください。":r.includes("timeout")?r="リクエストがタイムアウトしました。しばらく後にお試しください。":r.includes("404")?r="問題データファイルが見つかりません。":r.includes("500")&&(r="サーバーエラーが発生しました。しばらく後にお試しください。"),{success:!1,error:r}}}const V=new O,U=i=>V.loadQuestionSet(i);function q({}){return[{title:"クイズ - AWS CloudOps試験対策"},{name:"description",content:"AWS CloudOps試験の練習問題"}]}const G=I(function(){const[s]=T(),t=E(),[r,n]=f.useState([]),[o,l]=f.useState(!0),[m,a]=f.useState(null),c=s.get("mode")||"set",x=parseInt(s.get("count")||"10"),d=s.get("domain")||void 0,u={mode:c,questionCount:x,domain:d};f.useEffect(()=>{p()},[]);const p=async()=>{try{const g=await U();if(!g.success||!g.data)throw new Error(g.error||"問題データの読み込みに失敗しました");let y=g.data.questions;d&&(y=y.filter(C=>C.domain===d)),n(y),l(!1)}catch(g){a(g instanceof Error?g.message:"不明なエラーが発生しました"),l(!1)}},b=g=>{t("/result",{state:{session:g}})};return o?e.jsx(Y,{}):m?e.jsx(P,{onRetry:()=>{a(null),l(!0),p()}}):r.length===0?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-4",children:"問題が見つかりません"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"指定されたドメインの問題データが見つかりませんでした。"}),e.jsx("button",{onClick:()=>t("/"),className:"bg-blue-600 text-white px-6 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:"メニューに戻る"})]})}):e.jsx(F,{questions:r,config:u,onComplete:b})});export{G as default,q as meta};
